Compensation-based on-line query processing