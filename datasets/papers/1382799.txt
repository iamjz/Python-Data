Trapdoor pseudo-random number generators, with applications to protocol design