Atomic Snapshots in O (n log n) Operations