Automating the choice of consistency levels in replicated systems