Query optimization for parallel execution