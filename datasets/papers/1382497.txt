Concurrency control for database systems