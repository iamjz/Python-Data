Failure detection and consensus in the crash-recovery model