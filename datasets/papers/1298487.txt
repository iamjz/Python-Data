The Chubby lock service for loosely-coupled distributed systems