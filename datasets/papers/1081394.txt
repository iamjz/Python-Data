Necessary and sufficient conditions for broadcast consensus protocols