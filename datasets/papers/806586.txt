Design and verification of secure systems