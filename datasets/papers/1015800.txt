Brook for GPUs: stream computing on graphics hardware