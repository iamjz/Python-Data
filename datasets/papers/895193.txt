Middleware for Dependable Network Services in Partitionable Distributed Systems