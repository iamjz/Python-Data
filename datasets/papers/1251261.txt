Chain replication for supporting high throughput and availability