Distributed transactions for reliable systems