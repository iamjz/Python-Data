An adaptive totally ordered multicast protocol that tolerates partitions