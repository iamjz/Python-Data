Probing and fault injection of protocol implementations