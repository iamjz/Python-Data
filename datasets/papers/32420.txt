Preemptive scheduling under time and resource constraints