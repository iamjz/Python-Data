The art of metaobject protocol