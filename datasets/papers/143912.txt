Enhancing concurrency and availability for database systems