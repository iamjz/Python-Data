Distributed agreement in the presence of processor and communication faults