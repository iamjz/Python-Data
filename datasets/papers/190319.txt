Making greed work in networks: a game-theoretic analysis of switch service disciplines