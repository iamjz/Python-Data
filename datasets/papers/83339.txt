Recovery in distributed systems using optimistic message logging and check-pointing