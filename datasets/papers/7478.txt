Reliable communication in the presence of failures