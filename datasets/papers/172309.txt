Authentication and delegation with smart-cards