A unified approach to global program optimization