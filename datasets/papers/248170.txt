Hierarchical packet fair queueing algorithms