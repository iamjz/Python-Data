SPAR: a planner that satisfies operational and geometric goals in uncertain environments