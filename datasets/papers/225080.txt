Incremental cryptography and application to virus protection