Failure Detection and Consensus in the Crash-Recovery Model