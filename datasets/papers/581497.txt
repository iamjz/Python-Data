An expressive, scalable type theory for certified code