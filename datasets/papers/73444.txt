Two phase gossip: managing distributed event histories