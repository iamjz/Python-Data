A General Theory of Composition for Trace Sets Closed under Selective Interleaving Functions