ReVirt: enabling intrusion analysis through virtual-machine logging and replay