A stepwise refinement heuristic for protocol construction