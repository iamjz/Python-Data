Adapting to network and client variability via on-demand dynamic distillation