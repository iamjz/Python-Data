Declarative routing: extensible routing with declarative queries