CCured: type-safe retrofitting of legacy code