Offline Micropayments without Trusted Hardware