A Game Theoretic Framework for Incentives in P2P Systems