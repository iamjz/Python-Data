Making asynchronous parallelism safe for the world