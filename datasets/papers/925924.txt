Exploiting weak connectivity in a distributed file system