Active messages: a mechanism for integrated communication and computation