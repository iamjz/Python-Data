Recovery in distributed systems using asynchronous message logging and checkpointing