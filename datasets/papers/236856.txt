Transaction decomposition using transaction semantics