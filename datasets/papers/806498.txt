A hardware architecture for implementing protection rings