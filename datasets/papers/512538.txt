ESP: path-sensitive program verification in polynomial time