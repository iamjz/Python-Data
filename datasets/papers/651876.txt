Language Primitives and Type Discipline for Structured Communication-Based Programming