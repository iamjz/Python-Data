Optimal algorithms for Byzantine agreement