A communication-efficient canonical form for fault-tolerant distributed protocols