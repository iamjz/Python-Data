An adaptive quality of service aware middleware for replicated services