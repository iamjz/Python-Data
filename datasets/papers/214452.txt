Secure communication using remote procedure calls