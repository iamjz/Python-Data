System level fault-diagnosis in distributed systems