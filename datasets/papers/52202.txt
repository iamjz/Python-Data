Garbage collection in an uncooperative environment