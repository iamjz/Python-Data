Implementing cooperative prefetching and caching in a globally-managed memory system