Hierarchical correctness proofs for distributed algorithms