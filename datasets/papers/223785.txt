A critique of ANSI SQL isolation levels