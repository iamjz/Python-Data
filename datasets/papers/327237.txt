Implementing a cache consistency protocol