Implementing network protocols at user level