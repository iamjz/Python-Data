ARIES: a transaction recovery method supporting fine-granularity locking and partial rollbacks using write-ahead logging