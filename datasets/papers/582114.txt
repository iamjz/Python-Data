An optimality theory of concurrency control for databases