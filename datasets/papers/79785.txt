Exploiting logical structures in replicated databases