Executing functional programs on a virtual tree of processors