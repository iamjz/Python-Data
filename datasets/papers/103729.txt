Algorithms for scalable synchronization on shared-memory multiprocessors