System Support for Partition-Aware Network Applications