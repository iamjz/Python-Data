Structured message passing on a shared-memory multiprocessor