Witness-based cryptographic program checking and robust function sharing