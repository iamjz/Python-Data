An Efficient Technique for Tracking Nondeterministic Execution and its Applications