A framework for certified program analysis and its applications to mobile-code safety