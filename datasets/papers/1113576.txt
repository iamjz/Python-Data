MIDDLE-R: Consistent database replication at the middleware level