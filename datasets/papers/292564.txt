Typed memory management in a calculus of capabilities