Recovery and crash resistance in a filing system