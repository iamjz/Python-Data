Lightweight locking for main memory database systems