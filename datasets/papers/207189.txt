Implementation and evaluation of update-based cache protocols under relaxed memory consistency models