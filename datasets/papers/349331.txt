Functional reactive programming from first principles