Macros as multi-stage computations: type-safe, generative, binding macros in MacroML