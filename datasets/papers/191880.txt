Multi-step processing of spatial joins