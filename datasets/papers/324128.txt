Building a high-performance, programmable secure coprocessor