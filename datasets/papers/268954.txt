From system F to typed assembly language