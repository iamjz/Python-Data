ATUM: a new technique for capturing address traces using microcode