Mariposa: a wide-area distributed database system