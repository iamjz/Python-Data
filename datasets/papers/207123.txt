A type-based compiler for standard ML