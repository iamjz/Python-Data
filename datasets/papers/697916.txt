Encapsulating Failure Detection: From Crash to Byzantine Failures