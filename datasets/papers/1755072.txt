An improved protocol for demonstrating possession of discrete logarithms and some generalizations