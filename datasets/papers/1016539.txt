Free-riding and whitewashing in peer-to-peer systems