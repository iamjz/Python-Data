Constructing correct and efficient concurrent programs