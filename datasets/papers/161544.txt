Cooperative shared memory: software and hardware for scalable multiprocessors