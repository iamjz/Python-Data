A distributed algorithm for detecting resource deadlocks in distributed systems