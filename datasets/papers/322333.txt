A Theory of Safe Locking Policies in Database Systems