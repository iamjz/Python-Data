Viewstamped Replication: A New Primary Copy Method to Support Highly-Available Distributed Systems