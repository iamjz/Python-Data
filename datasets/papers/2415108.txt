Confluence analysis for distributed programs: a model-theoretic approach