BAR fault tolerance for cooperative services