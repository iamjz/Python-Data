Distributed Fault Tolerance: Lessons from Delta-4