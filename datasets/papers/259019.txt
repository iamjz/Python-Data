Multi-stage programming with explicit annotations