Concurrency control and recovery in database systems