An architecture for reliable decentralized systems