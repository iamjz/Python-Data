DPF: fast, flexible message demultiplexing using dynamic code generation