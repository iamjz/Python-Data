Detours: binary interception of Win32 functions