Deforestation: Transforming Programs to Eliminate Trees