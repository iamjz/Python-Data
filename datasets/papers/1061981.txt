Necessary and sufficient conditions on information for causal message ordering and their optimal implementation