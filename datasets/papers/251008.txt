Building shared trees using a one-to-many joining mechanism