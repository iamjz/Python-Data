HAIL: a language for easy and correct device access