iKP: a family of secure electronic payment protocols