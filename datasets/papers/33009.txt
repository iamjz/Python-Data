A Generalized Theory for System Level Diagnosis