A distributed algorithm for generalized deadlock detection