Design principles for tamper-resistant smartcard processors