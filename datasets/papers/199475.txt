Compiling polymorphism using intensional type analysis