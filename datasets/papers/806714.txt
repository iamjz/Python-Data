The failure and recovery problem for replicated databases