Capriccio: scalable threads for internet services