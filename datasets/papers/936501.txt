A type-preserving compiler infrastructure