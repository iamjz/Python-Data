Self-securing storage: protecting data in compromised system