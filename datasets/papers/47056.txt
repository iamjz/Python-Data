The MAFT Architecture for Distributed Fault Tolerance