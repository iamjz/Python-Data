Calvin: fast distributed transactions for partitioned database systems