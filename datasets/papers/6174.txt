The theory of database concurrency control