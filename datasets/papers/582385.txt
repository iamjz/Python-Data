Analysis of distributed commit protocols