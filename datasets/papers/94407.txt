A formal approach to recovery by compensating transactions