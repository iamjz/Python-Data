An algorithm for concurrency control and recovery in replicated distributed databases