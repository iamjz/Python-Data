CrystalBall: predicting and preventing inconsistencies in deployed distributed systems