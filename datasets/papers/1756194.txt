Public-key encryption in a multi-user setting: security proofs and improvements