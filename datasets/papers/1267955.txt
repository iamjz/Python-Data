Experience with a language for writing coherence protocols