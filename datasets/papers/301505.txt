Greedy algorithms in Datalog with choice and negation