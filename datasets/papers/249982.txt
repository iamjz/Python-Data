An adaptive data replication algorithm