OS Support for General-Purpose Routers