An Efficient Fair Off-Line Electronic Cash System with Extensions to Checks and Wallets with Observers