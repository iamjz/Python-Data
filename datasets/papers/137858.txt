Distributed algorithms for dynamic replication of data