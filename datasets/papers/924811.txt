A system for constructing configurable high-level protocols