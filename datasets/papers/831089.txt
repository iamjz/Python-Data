Optimal Implementation of the Weakest Failure Detector for Solving Consensus