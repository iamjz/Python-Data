Using smart clients to build scalable services