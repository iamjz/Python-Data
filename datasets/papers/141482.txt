Optimal Fault Diagnosis in Comparison Models