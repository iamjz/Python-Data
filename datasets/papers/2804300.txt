The implementation and use of a generic dataflow behaviour in Erlang