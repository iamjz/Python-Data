ATOM: a flexible interface for building high performance program analysis tools