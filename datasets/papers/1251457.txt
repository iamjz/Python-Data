Neptune: scalable replication management and programming support for cluster-based network services