Secure communications over insecure channels