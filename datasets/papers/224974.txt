A framework for protocol composition in Horus