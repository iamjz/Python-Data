A type-theoretic approach to higher-order modules with sharing