Optimal distributed algorithms for minimum weight spanning tree, counting, leader election, and related problems